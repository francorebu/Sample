name: Selenium Test

on:
  workflow_dispatch:

  push:
    branches: [main]
    
  schedule:
    - cron: '0 9 * * *'

jobs:
  build-and-test:
    runs-on: windows-latest

    steps:
      - name: Set up JDK 8
        uses: actions/setup-java@v1
        with:
          java-version: '8'

      - name: Checkout code
        uses: actions/checkout@v2
        
      - name: Download Chrome
        run: |
            curl -sSL -o chrome_installer.exe "https://dl.google.com/chrome/win32/stable/GGRO/googlechromestandaloneenterprise64.msi"
            Start-Process -Wait -FilePath "chrome_installer.exe" -ArgumentList "/silent /install"

        
      - name: Install Chromedriver
        run: |
          $desiredVersion = "113.0.5672.63"  # Replace with the desired Chromedriver version
          Invoke-WebRequest -Uri "https://chromedriver.storage.googleapis.com/$desiredVersion/chromedriver_win32.zip" -OutFile 'chromedriver_win32.zip'
          Expand-Archive -Path 'chromedriver_win32.zip' -DestinationPath 'C:\Automation\chromedriver_win32'
          Remove-Item -Path 'chromedriver_win32.zip'



          
      - name: Build with Maven
        run: mvn clean compile

      - name: Run Selenium tests
        run: mvn test -Dtest=LoginTest#validLoginTest
